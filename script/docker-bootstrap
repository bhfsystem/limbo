#!/usr/bin/env bash

function main {
  local net_bridge="$1"; shift

  set -x

  sudo aptitude install -y bridge-utils

  if [[ ! -x "$(which docker 2>&- || true)" ]]; then
    return 0
  fi

  if ifconfig br0 2>/dev/null; then
    return 0
  fi

  sudo brctl addbr br0
  sudo ip addr add "${net_bridge}/24" dev br0
  sudo ip link set dev br0 up
  sudo ip addr show br0

  sudo service docker start
}

source sub "$BASH_SOURCE" "$@"
